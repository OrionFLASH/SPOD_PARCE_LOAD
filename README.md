# SPOD_PARCE_LOAD - Система обработки данных конкурсов

## Описание проекта

SPOD_PARCE_LOAD - это система для обработки данных конкурсов, групп и индикаторов. Программа читает CSV файлы из каталога SPOD, обрабатывает JSON поля, объединяет данные и создает итоговый Excel файл с результатами.

## Основные возможности

- Чтение и обработка CSV файлов с данными конкурсов
- Разворачивание JSON полей в отдельные колонки
- Объединение данных из разных источников
- Создание итогового Excel файла с форматированием
- Поддержка нечувствительности к регистру при загрузке файлов
- Подробное логирование всех операций

## Структура проекта

```
SPOD_PARCE_LOAD/
├── main.py                    # Основная программа
├── generate_employee_data.py  # Генератор данных сотрудников
├── SPOD/                      # Входные данные (CSV файлы)
├── OUT/                       # Выходные файлы (Excel)
├── LOGS/                      # Логи работы программы
├── venv/                      # Виртуальное окружение Python
├── .git/                      # Git репозиторий
├── .gitignore                 # Игнорируемые файлы Git
└── README.md                  # Документация проекта
```

## Установка и настройка

### 1. Создание виртуального окружения

```bash
python3 -m venv venv
source venv/bin/activate  # На Linux/macOS
# или
venv\Scripts\activate     # На Windows
```

### 2. Установка зависимостей

```bash
pip install pandas openpyxl
```

### 3. Подготовка данных

Поместите CSV файлы в каталог `SPOD/`:
- `CONTEST-DATA (PROM) 2025-10-08 v1.csv` - данные конкурсов
- `GROUP (PROM) 2025-10-08 v0.csv` - данные групп  
- `INDICATOR (PROM) 2025-10-07 v0.csv` - данные индикаторов

## Использование

### Запуск основной программы

```bash
python main.py
```

### Запуск генератора данных сотрудников

```bash
python generate_employee_data.py
```

## Конфигурация

### Входные файлы

Программа настроена на обработку следующих файлов:

1. **CONTEST-DATA (PROM) 2025-10-08 v1.csv**
   - Лист: CONTEST-DATA
   - Максимальная ширина колонки: 120
   - Закрепление области: C2

2. **GROUP (PROM) 2025-10-08 v0.csv**
   - Лист: GROUP
   - Максимальная ширина колонки: 20
   - Закрепление области: C2

3. **INDICATOR (PROM) 2025-10-07 v0.csv**
   - Лист: INDICATOR
   - Максимальная ширина колонки: 100
   - Закрепление области: B2

### Поддержка нечувствительности к регистру

Программа автоматически находит файлы независимо от регистра расширения:
- `.csv`, `.CSV`, `.Csv` - все варианты поддерживаются
- Имена файлов также нечувствительны к регистру

## Логирование

Программа ведет подробные логи в каталоге `LOGS/`:
- `LOGS_INFO_YYYY-MM-DD.log` - основные сообщения
- `generate_employee_YYYY-MM-DD_HH-MM-SS.log` - логи генератора данных

## Выходные файлы

Результаты работы сохраняются в каталоге `OUT/`:
- `SPOD_ALL_IN_ONE_YYYY-MM-DD_HH-MM-SS.xlsx` - итоговый файл с данными
- Файлы содержат форматированные листы с данными конкурсов, групп и индикаторов

## Технические особенности

### Обработка JSON полей

Программа автоматически разворачивает JSON поля в отдельные колонки:
- `FEATURE` поля разворачиваются с префиксом `FEATURE_`
- `ADD_DATA` поля разворачиваются с префиксом `ADD_DATA_`

### Цветовое кодирование

Используется динамическая цветовая схема для визуального разделения данных:
- Разные цвета для разных типов полей
- Автоматическое определение цветов на основе содержимого

### Обработка ошибок

- Проверка существования входных файлов
- Валидация данных при обработке
- Подробное логирование ошибок
- Graceful handling несуществующих файлов

## История версий

### Версия 1.0 (Текущая)
- ✅ Базовая функциональность обработки данных
- ✅ Поддержка нечувствительности к регистру
- ✅ Относительные пути для кроссплатформенности
- ✅ Подробное логирование
- ✅ Цветовое кодирование результатов

### Изменения в путях
- Заменены абсолютные пути на относительные с использованием `os.path.join()`
- Добавлена поддержка нечувствительности к регистру при загрузке файлов
- Обеспечена кроссплатформенность (Windows, macOS, Linux)

## Требования

- Python 3.7+
- pandas
- openpyxl
- Стандартные библиотеки Python (os, sys, logging, datetime, json, re, csv)

## Поддержка

При возникновении проблем проверьте:
1. Правильность размещения CSV файлов в каталоге `SPOD/`
2. Наличие всех необходимых зависимостей
3. Логи в каталоге `LOGS/` для диагностики ошибок
4. Права доступа к каталогам `OUT/` и `LOGS/`

## Автор

Проект разработан для обработки данных системы SPOD (Система поддержки образовательных данных).

---

*Документация обновлена: $(date)*
