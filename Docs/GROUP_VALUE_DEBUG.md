# Отладка проблемы с GROUP_VALUE в Summary

## Проблема

Для CONTEST_CODE `01_2025-0_03-2-3`:
- В таблице GROUP есть только 2 строки:
  - BANK, GROUP_VALUE = "*"
  - TB, GROUP_VALUE = "*"
- В Summary попадает 22 строки с:
  - GROUP_CODE = только TB (нет BANK!)
  - GROUP_VALUE = [38], [40], [44], [13], [16], [18], [42], [52], [54], [55], [70] (не "*"!)

## Добавленное логирование

### 1. В функции collect_summary_keys:
- `[DEBUG GROUP]` - детальная информация о обработке GROUP
- Показывает найденные строки в GROUP
- Показывает создаваемые пары (GROUP_CODE, GROUP_VALUE)
- Показывает итоговые строки в Summary после collect_summary_keys

### 2. В функции build_summary_sheet:
- `[DEBUG SUMMARY]` - детальная информация о формировании Summary
- Показывает состояние Summary после collect_summary_keys
- Показывает данные в таблице GROUP для отладки
- Показывает состояние Summary до и после каждого merge_fields
- Показывает итоговый Summary

## Что проверить в логах

1. **После collect_summary_keys:**
   - Какие GROUP_CODE и GROUP_VALUE созданы?
   - Есть ли BANK в списке GROUP_CODE?
   - Все ли GROUP_VALUE равны "*"?

2. **При merge_fields из GROUP:**
   - Что происходит с GROUP_VALUE?
   - Создаются ли новые строки?
   - Меняются ли существующие GROUP_VALUE?

3. **Итоговый Summary:**
   - Откуда берутся значения [38], [40] и т.д.?
   - Почему нет BANK?
   - Почему GROUP_VALUE не "*"?

## Возможные причины

1. **GROUP_VALUE добавляется из другого источника** - нужно проверить все merge_fields для SUMMARY
2. **GROUP_VALUE преобразуется** - возможно, есть какая-то обработка данных
3. **Создаются новые строки** - возможно, multiply_rows или другая логика создает дополнительные строки
4. **Неправильный ключ в merge_fields** - возможно, ключ не совпадает и создаются новые строки

## Следующие шаги

1. Запустить программу
2. Проверить логи с метками `[DEBUG GROUP]` и `[DEBUG SUMMARY]`
3. Найти, где именно GROUP_VALUE меняется с "*" на [38], [40] и т.д.
4. Найти, почему BANK не попадает в Summary
