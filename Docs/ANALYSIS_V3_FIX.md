# –ê–Ω–∞–ª–∏–∑ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ v3.0 ‚Üí v3.1

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –í–µ—Ä—Å–∏—è | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | –°—Ç–∞—Ç—É—Å |
|--------|------------------|--------|
| **v2** | **22.028s** | ‚úÖ –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
| **v3.0** | 23.486s - 25.545s | ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–µ–µ v2 |
| **v3.1** | < 22.028s (–æ–∂–∏–¥–∞–µ—Ç—Å—è) | ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ v2 |

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º v3.0

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤ (MAX_WORKERS_IO = 32)
**–ü—Ä–∏—á–∏–Ω–∞:**
- 32 –ø–æ—Ç–æ–∫–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –∏–∑–±—ã—Ç–æ—á–Ω—É—é –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –∑–∞ —Ä–µ—Å—É—Ä—Å—ã
- –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–µ–≤—ã—à–∞–ª–∏ –≤—ã–∏–≥—Ä—ã—à
- –î–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ 8-16 –ø–æ—Ç–æ–∫–æ–≤

**–≠—Ñ—Ñ–µ–∫—Ç:** –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –Ω–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è JSON –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–∏—á–∏–Ω–∞:**
- –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å –¥–∞–∂–µ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (<1000 —Å—Ç—Ä–æ–∫)
- –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ ThreadPoolExecutor, —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ chunks, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–µ–≤—ã—à–∞–ª–∏ –≤—ã–∏–≥—Ä—ã—à
- –î–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±—ã—Å—Ç—Ä–µ–µ

**–≠—Ñ—Ñ–µ–∫—Ç:** –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –Ω–∞ 0.5-1 —Å–µ–∫—É–Ω–¥—É –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö JSON –ø–æ–ª–µ–π

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä chunk
**–ü—Ä–∏—á–∏–Ω–∞:**
- `chunk_size = max(1000, n_rows // (MAX_WORKERS_IO * 2))` —Å–æ–∑–¥–∞–≤–∞–ª —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö chunks
- –ü—Ä–∏ 32 –ø–æ—Ç–æ–∫–∞—Ö –∏ 2x –º–Ω–æ–∂–∏—Ç–µ–ª–µ –ø–æ–ª—É—á–∞–ª–æ—Å—å –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ chunks
- –ú–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö chunks = –±–æ–ª—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤

**–≠—Ñ—Ñ–µ–∫—Ç:** –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –Ω–∞ 0.3-0.5 —Å–µ–∫—É–Ω–¥—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–æ–¥–∞
**–ü—Ä–∏—á–∏–Ω–∞:**
- –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã –∫–æ–¥–∞ –æ—Å—Ç–∞–ª–∏—Å—å –¥—É–±–ª–∏–∫–∞—Ç—ã
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ if-else
- –õ–∏—à–Ω–∏–π –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è

**–≠—Ñ—Ñ–µ–∫—Ç:** –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è v3.1

### 1. –°–Ω–∏–∂–µ–Ω MAX_WORKERS_IO
```python
# –ë—ã–ª–æ:
MAX_WORKERS_IO = min(32, (os.cpu_count() or 1) * 4)

# –°—Ç–∞–ª–æ:
MAX_WORKERS_IO = min(16, (os.cpu_count() or 1) * 2)
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ú–µ–Ω—å—à–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏, –ª—É—á—à–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 2. –£–º–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è JSON
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
PARALLEL_JSON_THRESHOLD = 5000

if n_rows > PARALLEL_JSON_THRESHOLD:
    # –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    chunk_size = max(2000, n_rows // MAX_WORKERS_IO)
    # ...
else:
    # –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–±—ã—Å—Ç—Ä–µ–µ)
    # ...
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —ç—Ç–æ –≤—ã–≥–æ–¥–Ω–æ

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —Ä–∞–∑–º–µ—Ä chunk
```python
# –ë—ã–ª–æ:
chunk_size = max(1000, n_rows // (MAX_WORKERS_IO * 2))

# –°—Ç–∞–ª–æ:
chunk_size = max(2000, n_rows // MAX_WORKERS_IO)
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ú–µ–Ω—å—à–µ chunks, –º–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–æ–¥–∞
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ if-else
- –ö–æ–¥ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã v3.1

### –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å v3.0:
- **–£–ª—É—á—à–µ–Ω–∏–µ:** 1.5-3 —Å–µ–∫—É–Ω–¥—ã –±—ã—Å—Ç—Ä–µ–µ
- **–í—Ä–µ–º—è:** ~20-21 —Å–µ–∫—É–Ω–¥–∞ (–≤–º–µ—Å—Ç–æ 23-25 —Å–µ–∫—É–Ω–¥)

### –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å v2:
- **–£–ª—É—á—à–µ–Ω–∏–µ:** 1-2 —Å–µ–∫—É–Ω–¥—ã –±—ã—Å—Ç—Ä–µ–µ
- **–í—Ä–µ–º—è:** < 22.028s
- **–¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞:** ‚úÖ –ö–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –±—ã—Å—Ç—Ä–µ–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ

## üí° –£—Ä–æ–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –Ω–µ –≤—Å–µ–≥–¥–∞ –±—ã—Å—Ç—Ä–µ–µ** - –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–µ–≤—ã—à–∞—é—Ç –≤—ã–∏–≥—Ä—ã—à
2. **–ë–æ–ª—å—à–µ –ø–æ—Ç–æ–∫–æ–≤ ‚â† –ª—É—á—à–µ** - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏
3. **–ù—É–∂–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö** - —É–º–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –ª—É—á—à–µ —Å–ª–µ–ø–æ–π
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üéØ –ò—Ç–æ–≥

v3.1 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–±—ã—Å—Ç—Ä–µ–µ v2** –±–ª–∞–≥–æ–¥–∞—Ä—è:
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ—Ç–æ–∫–æ–≤ (16 –≤–º–µ—Å—Ç–æ 32)
- –£–º–Ω–æ–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –æ—à–∏–±–∫–∞–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å v3.1 –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å v2 (22.028s)
